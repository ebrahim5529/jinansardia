---
name: إعدادات الموقع وطلبات الاتصال
overview: إنشاء نظام إدارة إعدادات الموقع (Footer) وعرض طلبات الاتصال في قسم admin، مع تحديث قاعدة البيانات وAPI endpoints
todos:
  - id: update-prisma-schema
    content: تحديث Prisma schema بإضافة جدول ContactSubmission و WebsiteSettings
    status: completed
  - id: create-contact-api
    content: إنشاء API endpoint لحفظ طلبات الاتصال (/api/contact/submit)
    status: completed
    dependencies:
      - update-prisma-schema
  - id: create-website-settings-api
    content: إنشاء API endpoints لإدارة إعدادات الموقع (/api/admin/website-settings)
    status: completed
    dependencies:
      - update-prisma-schema
  - id: create-contact-submissions-api
    content: إنشاء API endpoint لجلب طلبات الاتصال (/api/admin/contact-submissions)
    status: completed
    dependencies:
      - update-prisma-schema
  - id: create-website-settings-page
    content: إنشاء صفحة إعدادات الموقع (/settings/website) مع نموذج تعديل Footer
    status: completed
    dependencies:
      - create-website-settings-api
  - id: create-contacts-page
    content: إنشاء صفحة عرض طلبات الاتصال (/settings/contacts) مع جدول وفلترة
    status: completed
    dependencies:
      - create-contact-submissions-api
  - id: update-footer-component
    content: تحديث Footer.tsx لقراءة البيانات من API بدلاً من القيم الثابتة
    status: completed
    dependencies:
      - create-website-settings-api
  - id: update-contact-page
    content: تحديث صفحة contact لحفظ البيانات في قاعدة البيانات
    status: completed
    dependencies:
      - create-contact-api
  - id: add-navigation-links
    content: إضافة روابط صفحات إعدادات الموقع في قائمة admin
    status: completed
    dependencies:
      - create-website-settings-page
      - create-contacts-page
---

# خطة إعدادات الموقع وطلبات الاتصال

## الهدف

إنشاء صفحة إعدادات الموقع في قسم admin تسمح بـ:

1. تعديل جميع معلومات Footer (الوصف، الروابط، معلومات الاتصال، وسائل التواصل)
2. عرض وإدارة طلبات الاتصال من صفحة `/contact`

## الملفات المطلوبة

### 1. تحديث Prisma Schema

- إضافة جدول `ContactSubmission` لتخزين طلبات الاتصال
- إضافة جدول `WebsiteSettings` لتخزين إعدادات الموقع

### 2. API Endpoints

- `src/app/api/contact/submit/route.ts` - حفظ طلبات الاتصال
- `src/app/api/admin/website-settings/route.ts` - CRUD لإعدادات الموقع
- `src/app/api/admin/contact-submissions/route.ts` - جلب طلبات الاتصال

### 3. صفحات Admin

- `src/app/(admin)/settings/website/page.tsx` - صفحة إعدادات الموقع
- `src/app/(admin)/settings/contacts/page.tsx` - صفحة عرض طلبات الاتصال

### 4. تحديث المكونات

- `src/components/landing/Footer.tsx` - قراءة البيانات من API بدلاً من القيم الثابتة
- `src/app/contact/page.tsx` - حفظ البيانات في قاعدة البيانات

## التفاصيل التقنية

### Prisma Schema Updates

```prisma
model ContactSubmission {
  id        String   @id @default(cuid())
  name      String
  email     String
  subject   String
  message   String   @db.Text
  status    String   @default("pending") // pending, read, replied, archived
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model WebsiteSettings {
  id        String   @id @default(cuid())
  key       String   @unique
  value     String   @db.Text
  updatedAt DateTime @updatedAt
  updatedBy String?
}
```

### هيكل إعدادات الموقع

- `footer.description` - وصف الشركة
- `footer.email` - البريد الإلكتروني
- `footer.phone` - رقم الهاتف
- `footer.address` - العنوان
- `footer.links` - الروابط السريعة (JSON)
- `footer.social` - روابط وسائل التواصل (JSON)
- `footer.copyright` - نص حقوق النشر

### صفحة إعدادات الموقع

- تبويبات: Footer Settings, Contact Submissions
- نموذج لتعديل جميع معلومات Footer
- معاينة مباشرة للتغييرات
- حفظ التغييرات في قاعدة البيانات

### صفحة طلبات الاتصال

- جدول يعرض جميع الطلبات
- فلترة حسب الحالة (pending, read, replied)
- عرض تفاصيل كل طلب
- تحديث حالة الطلب
- إمكانية الرد على الطلبات

## خطوات التنفيذ

1. تحديث Prisma schema وإجراء migration
2. إنشاء API endpoints
3. إنشاء صفحة إعدادات الموقع
4. إنشاء صفحة طلبات الاتصال
5. تحديث Footer لقراءة البيانات ديناميكياً
6. تحديث صفحة contact لحفظ البيانات
7. إضافة روابط في قائمة admin settings

## ملاحظات

- استخدام localStorage كبديل مؤقت إذا لم تكن قاعدة البيانات جاهزة
- إضافة validation للبيانات المدخلة
- دعم الوضع الداكن في جميع الصفحات
- إضافة pagination لصفحة طلبات الاتصال إذا كانت كثيرة