# اختبار نموذج الاتصال

## خطوات التحقق من أن البيانات تظهر في لوحة التحكم

### 1. التأكد من تشغيل Migration

قبل البدء، تأكد من تشغيل Prisma migration:

```bash
npx prisma migrate dev --name add_website_settings_and_contact_submissions
npx prisma generate
```

### 2. اختبار إرسال البيانات

1. افتح المتصفح واذهب إلى: `http://localhost:3000/contact`
2. املأ النموذج:
   - الاسم: اختبار
   - البريد الإلكتروني: test@example.com
   - الموضوع: اختبار الاتصال
   - الرسالة: هذه رسالة اختبار
3. اضغط على "إرسال"
4. يجب أن تظهر رسالة نجاح: "تم إرسال رسالتك بنجاح"

### 3. التحقق من البيانات في لوحة التحكم

1. اذهب إلى: `http://localhost:3000/settings/contacts`
2. يجب أن تظهر البيانات المرسلة في الجدول
3. الحالة الافتراضية: "قيد الانتظار" (pending)

### 4. الميزات المتاحة

- **عرض التفاصيل**: اضغط على أيقونة العين لعرض تفاصيل الطلب
- **تغيير الحالة**: اختر حالة جديدة من القائمة المنسدلة
- **البحث**: استخدم حقل البحث للبحث بالاسم، البريد، أو الموضوع
- **التصفية**: استخدم قائمة الحالة لتصفية الطلبات
- **الحذف**: اضغط على أيقونة الحذف لحذف طلب

### 5. حالات الطلبات

- **قيد الانتظار** (pending) - الحالة الافتراضية
- **مقروء** (read) - تم قراءة الطلب
- **تم الرد** (replied) - تم الرد على الطلب
- **مؤرشف** (archived) - تم أرشفة الطلب

### 6. استكشاف الأخطاء

إذا لم تظهر البيانات:

1. **تحقق من Console**:
   - افتح Developer Tools (F12)
   - اذهب إلى Console
   - تحقق من وجود أخطاء

2. **تحقق من Network**:
   - اذهب إلى Network tab
   - تحقق من أن `/api/contact/submit` يعيد status 201
   - تحقق من أن `/api/admin/contact-submissions` يعيد status 200

3. **تحقق من قاعدة البيانات**:
   ```bash
   npx prisma studio
   ```
   - افتح جدول `ContactSubmission`
   - تحقق من وجود البيانات

4. **تحقق من Prisma Schema**:
   - تأكد من أن `ContactSubmission` موجود في `prisma/schema.prisma`
   - تأكد من تشغيل migration

### 7. API Endpoints

- **POST** `/api/contact/submit` - إرسال نموذج الاتصال
- **GET** `/api/admin/contact-submissions` - جلب جميع الطلبات (يتطلب تسجيل الدخول)
- **PATCH** `/api/admin/contact-submissions` - تحديث حالة الطلب
- **DELETE** `/api/admin/contact-submissions?id=...` - حذف طلب

### 8. ملاحظات

- البيانات تُحفظ تلقائياً في قاعدة البيانات عند الإرسال
- الصفحة تُحدث البيانات تلقائياً عند تغيير الفلتر أو الصفحة
- البحث يعمل على البيانات المحملة في الصفحة الحالية فقط
